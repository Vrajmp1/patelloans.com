var list_ekadashi = [[12, 14, 2021, 'Tuesday', 'મોક્ષદા એકાદશી', 'e'], 
                     [12, 30, 2021, 'Thursday', 'સફલા એકાદશી', 'e'], 
                     [1, 13, 2022, 'Thursday', 'પુત્રદા એકાદશી', 'e'], 
                     [1, 28, 2022, 'Friday', 'ષટતિલા એકાદશી', 'e'], 
                     [2, 12, 2022, 'Saturday', 'જયા એકાદશી', 'e'], 
                     [2, 27, 2022, 'Sunday', 'વિજયા એકાદશી', 'e'], 
                     [3, 14, 2022, 'Monday', 'આમલકી એકાદશી', 'e'], 
                     [3, 28, 2022, 'Monday', 'પાપમોચની એકાદશી', 'e'], 
                     [4, 10, 2022, 'Sunday', 'શ્રી હરિ જયંતી', 'h'], 
                     [4, 12, 2022, 'Tuesday', 'કામદા એકાદશી', 'e'], 
                     [4, 26, 2022, 'Tuesday', 'વરુથિની એકાદશી', 'e'], 
                     [5, 12, 2022, 'Thursday', 'મોહિની એકાદશી', 'e'], 
                     [5, 26, 2022, 'Thursday', 'અપરા એકાદશી', 'e'], 
                     [6, 11, 2022, 'Saturday', 'ભીમ એકાદશી', 'e'], 
                     [6, 24, 2022, 'Friday', 'યોગિની એકાદશી', 'e'], 
                     [7, 10, 2022, 'Sunday', 'દેવશયની એકાદશી', 'e'], 
                     [7, 24, 2022, 'Sunday', 'કામિકા એકાદશી', 'e'], 
                     [8, 8, 2022, 'Monday', 'પવિત્રા એકાદશી', 'e'], 
                     [8, 19, 2022, 'Friday', 'જન્માષ્ટમી', 'j'],
                     [8, 23, 2022, 'Tuesday', 'અજા એકાદશી', 'e'], 
                     [9, 7, 2022, 'Wednesday', 'પરિવર્તની એકાદશી', 'e'], 
                     [9, 21, 2022, 'Wednesday', 'ઇન્દિરા એકાદશી', 'e'], 
                     [10, 6, 2022, 'Thursday', 'પાશાંકુશા એકાદશી', 'e'], 
                     [10, 21, 2022, 'Friday', 'રમા એકાદશી', 'e'], 
                     [11, 4, 2022, 'Friday', 'પ્રબોધિની એકાદશી', 'e'], 
                     [11, 20, 2022, 'Sunday', 'ઉત્પત્તિ એકાદશી', 'e'],
                     [12, 4, 2022, 'Sunday', 'મોક્ષદા એકાદશી', 'e'],
                     [12, 19, 2022, 'Monday', 'સફલા એકાદશી', 'e'],
                     [1, 2, 2023, 'Monday', 'પુત્રદા એકાદશી', 'e'],
                     [1, 18, 2023, 'Wednesday', 'ષટતિલા એકાદશી', 'e'],
                     [2, 1, 2023, 'Wednesday','જયા એકાદશી', 'e'],
                     [2, 17, 2023, 'Friday', 'વિજયા એકાદશી', 'e'],
                     [2, 18, 2023, 'Saturday', 'મહા શિવરાત્રી', 's'],
                     [3, 3, 2023, 'Friday', 'આમલકી એકાદશી', 'e'],
                     [3, 18, 2023, 'Saturday', 'પાપમોચની એકાદશી', 'e'],
                     [3, 30, 2023, 'Thursday', 'શ્રી હરિ જયંતી', 'h'],
                     [4, 1, 2023, 'Saturday', 'કામદા એકાદશી', 'e'],
                     [4, 16, 2023, 'Sunday', 'વરુથિની એકાદશી', 'e'],
                     [5, 1, 2023, 'Monday', 'મોહિની એકાદશી', 'e'],
                     [5, 15, 2023, 'Monday', 'અપરા એકાદશી', 'e'],
                     [5, 31, 2023, 'Wednesday', 'ભીમ એકાદશી', 'e'],
                     [6, 14, 2023, 'Wednesday', 'યોગિની એકાદશી', 'e'],
                     [6, 29, 2023, 'Thursday', 'દેવશયની એકાદશી', 'e'],
                     [7, 13, 2023, 'Thursday', 'કામિકા એકાદશી', 'e'],
                     [7, 29, 2023, 'Saturday', 'કમલા એકાદશી', 'e'],
                     [8, 12, 2023, 'Saturday', 'કમલા એકાદશી ', 'e'],
                     [8, 27, 2023, 'Sunday', 'પુત્રદા-પવિત્રા એકાદશી', 'e'],
                     [9, 7, 2023, 'Thursday', 'જન્માષ્ટમી', 'j'],
                     [9, 10, 2023, 'Sunday', 'અજા એકાદશી', 'e'],
                     [9, 26, 2023, 'Tuesday', 'જલઝીલણી એકાદશી', 'e'],
                     [10, 10, 2023, 'Tuesday', 'ઇન્દિરા એકાદશી', 'e'],
                     [10, 25, 2023, 'Wednesday', 'પાશાંકુશા એકાદશી', 'e'],
                     [11, 9, 2023, 'Thursday', 'રમા એકાદશી', 'e'],
                     [11, 23, 2023, 'Thursday', 'પ્રબોધિની એકાદશી', 'e'],
                     [12, 9, 2023, 'Saturday', 'ઉત્પત્તિ એકાદશી', 'e'],
                     [12, 23, 2023, 'Saturday', 'મોક્ષદા એકાદશી', 'e'],
                     [1, 7, 2024, 'Sunday', 'સફલા એકાદશી', 'e'],
                     [1, 21, 2024, 'Sunday', 'પુત્રદા એકાદશી', 'e'],
                     [2, 6, 2024, 'Tuesday', 'ષટતિલા એકાદશી', 'e'],
                     [2, 20, 2024, 'Tuesday', 'જયા એકાદશી', 'e'],
                     [3, 7, 2024, 'Thursday', 'વિજયા એકાદશી', 'e'],
                     [3, 8, 2024, 'Friday', 'મહા શિવરાત્રી', 's'],
                     [3, 20, 2024, 'Wednesday', 'આમલકી એકાદશી', 'e'],
                     [4, 5, 2024, 'Friday', 'પાપમોચની એકાદશી', 'e'],
                     [4, 17, 2024, 'Wednesday', 'શ્રી હરિ જયંતી', 'h'],
                     [4, 19, 2024, 'Friday,', 'કામદા એકાદશી', 'e'],
                     [5, 4, 2024, 'Saturday', 'વરુથિની એકાદશી', 'e'],
                     [5, 19, 2024, 'Sunday', 'મોહિની એકાદશી', 'e'],
                     [6, 3, 2024, 'Monday', 'અપરા એકાદશી', 'e'],
                     [6, 18, 2024, 'Tuesday', 'ભીમ એકાદશી', 'e'],
                     [7, 2, 2024, 'Tuesday', 'યોગિની એકાદશી', 'e'],
                     [7, 17, 2024, 'Wednesday', 'દેવશયની એકાદશી', 'e'],
                     [7, 31, 2024, 'Wednesday', 'કામિકા એકાદશી', 'e'],
                     [8, 16, 2024, 'Friday', 'પુત્રદા-પવિત્રા એકાદશી', 'e'],
                     [8, 26, 2024, 'Monday', 'જન્માષ્ટમી', 'j'],
                     [8, 29, 2024, 'Thursday', 'અજા એકાદશી', 'e'],
                     [9, 14, 2024, 'Saturday', 'જલઝીલણી એકાદશી', 'e'],
                     [9, 28, 2024, 'Saturday', 'ઇન્દિરા એકાદશી', 'e'],
                     [10, 14, 2024, 'Monday', 'પાશાંકુશા એકાદશી', 'e'],
                     [10, 28, 2024, 'Monday', 'રમા એકાદશી', 'e'],
                     [11, 12, 2024, 'Tuesday', 'પ્રબોધિની એકાદશી', 'e'],
                     [11, 26, 2024, 'Tuesday', 'ઉત્પત્તિ એકાદશી', 'e'],
                     [12, 11, 2024, 'Wednesday', 'મોક્ષદા એકાદશી', 'e'],
                     [12, 26, 2024, 'Thursday', 'સફલા એકાદશી', 'e'],
                     [1, 10, 2025, 'Friday', 'પુત્રદા એકાદશી', 'e'],
                     [1, 25, 2025, 'Saturday', 'ષટતિલા એકાદશી', 'e']]



var num_in_list = list_ekadashi.length - 1;

var num_to_month = {1:'January',
                    2:'February',
                    3:'March',
                    4:'April',
                    5:'May',
                    6:'June',
                    7:'July',
                    8:'August',
                    9:'September',
                    10:'October',
                    11:'November',
                    12:'December'
                   }

var days_in_months = {1:31,
                  2:28,
                  3:31,
                  4:30,
                  5:31,
                  6:30,
                  7:31,
                  8:31,
                  9:30,
                  10:31,
                  11:30,
                  12:31}


var current_index = 0;

//change today's date--------------------------------------------------
var today = new Date();

var cur_day = today.getDate();
var cur_mon = (today.getMonth()+1);
var cur_yr = today.getFullYear();

document.getElementById("cur-day").innerHTML = cur_day;
document.getElementById("cur-yr").innerHTML = cur_yr;
document.getElementById("cur-mon").innerHTML = num_to_month[cur_mon];

var date = cur_day +'-'+cur_mon+'-'+cur_yr;

console.log(date);

//--------------------------------------------------------------------
//Find current index -------------------------------------------------
for (let i=0;i<=num_in_list;i++){
  let days_remaining = days_left(cur_mon,cur_day,list_ekadashi[i][0],list_ekadashi[i][1],cur_yr,list_ekadashi[i][2]);
  if (days_remaining>=0){
    current_index = i;
    break;
  }
}



//--------------------------------------------------------------------
var prev = 'e';
change(list_ekadashi[current_index]);

let viewport_width = document.documentElement.clientWidth;
console.log(viewport_width);

if (viewport_width < 550) {
  let control_row = document.getElementById("controls");
  control_row.style.marginLeft = "-20%";
  control_row.style.marginTop = "-10%";
  let img = document.getElementsByTagName('img')[0];
  img.style.marginLeft = "10px";
}
else{
  let next = document.getElementById("next-button");
  next.style.transform = "translateX(25%)"
}


  
function change(particulars){
  if (particulars[5]==='h') {
    let img = document.getElementById("card-img");
    img.src = "Harikrishnaji.jpg";
    prev = "h";
  }
  else if (particulars[5]==='j'){
    let img = document.getElementById("card-img");
    img.src = "krishna.jpg";
    prev = "j";
  }
  else if (particulars[5]==='s'){
    let img = document.getElementById("card-img");
    img.src = "shivratri.jpg";
    prev = "s";
  }
  else if (prev === 'h' || prev === 'j' || prev === 's') {
    let img = document.getElementById("card-img");
    img.src = "fruit_basket.jpg"
    prev = "e";
  }
  let month = particulars[0];
  let day = particulars[1];
  document.getElementsByTagName("p")[0].innerHTML = num_to_month[month];
  let date = document.getElementsByTagName("p")[1];
  date.innerHTML = day;
  if (String(day).length==1){
    console.log('True');
    date.style.marginLeft = "130%";
  }
  else {
    date.style.marginLeft = "55%";
  }
  
  document.getElementsByTagName("p")[2].innerHTML = particulars[4];
  document.getElementsByTagName("p")[3].innerHTML = particulars[3];
  document.getElementById("cur-yr-title").innerHTML = particulars[2]

  let days_till_ekadashi = days_left(cur_mon,cur_day,month,day,cur_yr,particulars[2]);
  let remaining_element = document.getElementById("days-remaining");

  if (days_till_ekadashi<7 && days_till_ekadashi>0){
    document.getElementsByTagName("p")[3].innerHTML = 'Next ' + particulars[3];
  }
  else if (days_till_ekadashi<4 && days_till_ekadashi>0){
    document.getElementsByTagName("p")[3].innerHTML = 'This coming ' + particulars[3];
  }
  else if (days_till_ekadashi==0){
    //alert("Ekadashi is today. Ekadashi na bhavthi Jay Swaminarayan.🙏");
  }
  
  if (days_till_ekadashi==1){
    remaining_element.innerHTML = "Ekadashi is tomorrow";
    remaining_element.style.color == "red";
    remaining_element.style.fontSize == "40px";
  }
  else if (days_till_ekadashi==0){
    remaining_element.innerHTML = "Ekadashi is TODAY";
    remaining_element.style.color == "green";
    remaining_element.style.fontSize = "50px";
  }
  else if (days_till_ekadashi<0){
    remaining_element.innerHTML = `Ekadashi passed ${days_till_ekadashi} days ago`;
  }
  else {
    remaining_element.innerHTML = `${days_till_ekadashi} days left`
  }

}

function forward(){
  if (current_index<num_in_list){
    current_index += 1;
    change(list_ekadashi[current_index]);
  }
  else
    console.log('Jay Swaminarayan Forward no more');
}

function previous(){
  if (current_index>0){
    current_index -= 1;
    change(list_ekadashi[current_index]);
  }
  else
    console.log('Jay Swaminarayan Previous no more');
}

function days_left(month1,day1,month2,day2,year,ek_year){
  if (year==ek_year){
    let days1 = 0;
    let days2 = 0;
    for (let i=1;i<=12; i++) {
      if (i<month1) {
        days1 = (days1 + days_in_months[i]);
      }
      else 
        days1 = days1;
    }
    for (let j=1; j<=12; j++){
      if (j < month2)
        days2 = (days2 + days_in_months[j]);
      else
        days2;
    }
    if (year%4!=0)
        return (days2+day2)-(days1+day1);
    else if((month1<2) || (month1==2 && day1<29) && ((month2>2))) {
        return (days2+day2)-(days1+day1)+1;
    }
    else
        return (days2+day2)-(days1+day1);
  }
  else if (ek_year<year){
    let days = 0, yr_indicator = ek_year;
    days = days_left(month2,day2,12,31,ek_year,ek_year)+1;
    yr_indicator += 1;
    while(yr_indicator<year){
      days += days_left(1,1,12,31,yr_indicator,yr_indicator)+1;
      yr_indicator+=1;
    }
    days += days_left(1,1,month1,day1,year,year);
    return -(days);
  }
  else {
    let days = 0, yr_indicator = year;
    days = days_left(month1,day1,12,31,year,year)+1;
    console.log(days);
    yr_indicator += 1;
    while(yr_indicator<ek_year){
      days += days_left(1,1,12,31,yr_indicator,yr_indicator)+1;
      console.log(days);
      yr_indicator+=1;
    }
    days += days_left(1,1,month2,day2,ek_year,ek_year);
    console.log(days);
    return days;
  }
    
}
